<!doctype html>
<!--
		lucidtail
		ie. lucidtail *.log
		Copyright (C) 2013	David Duong

		https://github.com/davidnqd/lucidtail

		This program is free software: you can redistribute it and/or modify
		it under the terms of the GNU Affero General Public License as published by
		the Free Software Foundation, either version 3 of the License, or
		(at your option) any later version.

		This program is distributed in the hope that it will be useful,
		but WITHOUT ANY WARRANTY; without even the implied warranty of
		MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the
		GNU Affero General Public License for more details.

		You should have received a copy of the GNU Affero General Public License
		along with this program.	If not, see <http://www.gnu.org/licenses/>.
--> 
<html lang='en'>
<head>
	<meta charset='utf-8' />
	<title>lucidtail</title>
	<link rel='stylesheet' href='http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css' />
	<script src='http://code.jquery.com/jquery-2.0.0.js'></script>
	<script src='http://code.jquery.com/ui/1.10.2/jquery-ui.js'></script>

	<link rel='stylesheet' href='style.css' />
	<script src='socket.io/socket.io.js'></script>
	<script src='client.js'></script>
	<script>
	// getQuerystring from:
	// http://www.bloggingdeveloper.com/post/JavaScript-QueryString-ParseGet-QueryString-with-Client-Side-JavaScript.aspx
	function getQuerystring(key, default_)
	{
		if (default_ == null) default_ = ""; 
		key = key.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
		var regex = new RegExp("[\\?&]" + key + "=([^&#]*)");
		var qs = regex.exec(window.location.href);
		if(qs == null)
			return default_;
		else
			return qs[1];
	}

	$(function() {
		$( '#tail-tabs' ).tabs().addClass( 'ui-tabs-vertical ui-helper-clearfix' );
		$( '#tail-tabs li' ).removeClass( 'ui-corner-top' ).addClass( 'ui-corner-left' );

		new Client()
			.asResultsPane($( '#tail-results' ))
			.asMessageFilter($( '#tail-filter' ))
			.asHighlighter($( '#highlight-filter' ))
			.asFilter($( '#tail-sources' ), 'source')
			.asPause($('#tail-pause'))
			.listen(io.connect(getQuerystring('of')));
	});
	</script>
</head>
<body>

<div id='tail-tabs'>
	<ul>
		<li><a href='#tail-filter-tab'>Filter</a></li>
		<li><a href='#tail-highlight-tab'>Highlight</a></li>
	</ul>
	<div id='tail-filter-tab'>
		<label for='tail-filter'>Message: </label>
		<input id='tail-filter' size='50' />
		<label for='tail-sources'>Sources: </label>
		<input id='tail-sources' size='50' /> <br/>
		<p>Show events which match <em>all</em> filters.</p>
	</div>
	<div id='tail-highlight-tab'>
		<label for='highlight-filter'>Message: </label>
		<input id='highlight-filter' size='50' />
		<p>Highlight events which match <em>all</em> filters.</p>
	</div>
</div>
<input type="checkbox" id="tail-pause" /><label for="tail-pause">&#10074;&#10074; Pause</label>
<div id='tail-results' class='results'></div>
</body>
</html>